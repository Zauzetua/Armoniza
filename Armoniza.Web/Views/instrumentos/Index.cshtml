@using Armoniza.Application.Common.Models
@model List<InstrumentosViewModel>

@{
    ViewData["Title"] = "Instrumentos por Categoría";
}

<div class="container mt-4">
    

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="text-primary"><i class="bi bi-music-note-list"></i> Instrumentos</h2>
        <a asp-action="Create" class="btn btn-success"><i class="bi bi-plus-circle"></i> Nuevo Instrumento</a>
    </div>
    <div class="accordion" id="accordionCategorias">
        @for (int i = 0; i < Model.Count; i++)
        {
            var categoria = Model[i];
            string collapseId = $"collapse{i}";

            <div class="accordion-item">
                <h2 class="accordion-header" id="heading@i">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#@collapseId" aria-expanded="false" aria-controls="@collapseId">
                        <i class="bi bi-tags"></i> @categoria.NombreCategoria
                    </button>
                </h2>
                <div id="@collapseId" class="accordion-collapse collapse" aria-labelledby="heading@i" data-bs-parent="#accordionCategorias">
                    <div class="accordion-body">
                        @if (categoria.Instrumentos.Count == 0)
                        {
                            <p class="text-muted">No hay instrumentos disponibles.</p>
                        }
                        else
                        {
                            <table class="table table-hover table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th>Codigo</th>
                                        <th>Nombre</th>
                                        <th>Estuche</th>
                                        <th>Funcional</th>
                                        <th>Ocupado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var inst in categoria.Instrumentos)
                                    {
                                        <tr>
                                            <td>@inst.codigo</td>
                                            <td>@inst.nombre</td>
                                            <td>@(inst.estuche ? "Sí" : "No")</td>
                                            <td>@(inst.funcional ? "Sí" : "No")</td>
                                            <td>@(inst.ocupado ? "Sí" : "No")</td>
                                            <td>
                                                <a asp-action="Details" asp-route-id="@inst.codigo" class="btn btn-sm btn-primary"><i class="bi bi-eye"></i></a>
                                                <a asp-action="Edit" asp-route-id="@inst.codigo" class="btn btn-sm btn-warning"><i class="bi bi-pencil"></i></a>
                                                <a asp-action="Delete" asp-route-id="@inst.codigo" class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>
